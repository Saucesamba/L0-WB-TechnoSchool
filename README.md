# Orders Microservice

Демонстрационный сервис с простейшим веб-интерфейсом для отображения данных о заказе.

## Описание

Этот проект представляет собой небольшой микросервис на Go, предназначенный для демонстрации основных принципов работы с базами данных и очередями сообщений. Сервис получает данные о заказах из Kafka, сохраняет их в PostgreSQL и предоставляет API для просмотра информации о заказах через веб-интерфейс.

**Основные технологии:**

*   Go;
*   Kafka;
*   PostgreSQL;
*   Docker.

Также, постарался придерживаться принципов Clean Architecture.

**Основные компоненты:**

*   **Producer:**  Генерирует тестовые данные о заказах и отправляет их в Kafka.
*   **Consumer:**  Подписывается на топик Kafka, получает сообщения о заказах и сохраняет их в PostgreSQL.
*   **Cache:** Хранит последние полученные данные о заказах в памяти для быстрого доступа. Используется LRU-кэш на основе `map` и двусвязного списка.
*   **HTTP API:** Предоставляет эндпоинт для получения информации о заказе по ID.
*   **Web Interface:**  Простой веб-интерфейс для ввода ID заказа и отображения информации о нём.

## Инструкция по запуску

1.  **Клонируйте репозиторий:**

    ```bash
    git clone https://github.com/Saucesamba/L0-WB-TechnoSchool.git
    ```
2. **Создайте таблицы в базе данных:**

    Выполните SQL-скрипт `init.sql`, чтобы создать таблицы и пользователя в вашей базе данных PostgreSQL. Это можно сделать, например, с помощью `psql`:

    ```bash
    psql -h <host> -p <port> -U <user> -f init.sql
    ```
    *   Замените `<host>`, `<port>`, `<user>` на соответствующие значения.

3. **Запустите Kafka и ZooKeeper:**

    ```bash
    docker-compose up -d 
    ```

4. **Запустите приложение:**

    ```bash
    go mod download
    go run cmd/service/main.go
    ```

5. **Запустите Kafka Producer (для генерации тестовых данных):**

    В отдельном терминале запустите Kafka Producer:

    ```bash
    go run cmd/producer/main.go
    ```

## Использование

1.  **Откройте веб-интерфейс в браузере:**

    Перейдите по адресу `http://localhost:8080/order/`.

2.  **Введите ID заказа:**

    Введите UUID заказа (можно получить из БД, после генерации тестовых данных) в текстовое поле "Order ID".

3.  **Получите информацию о заказе:**

    Нажмите кнопку "Get Order". На странице отобразится информация о заказе в формате JSON.

## Дополнительная информация

*   **Кэширование:** Сервис использует LRU-кэш для ускорения доступа к данным. При перезапуске данные загружаются из базы данных и сохраняются в кэше. При повторных запросах данные берутся из кэша, что ускоряет время ответа.
*   **Конфигурация:** Параметры конфигурации можно задавать с помощью файла `config.yaml`.
*   **Логирование:**  Сервис использует логирование для отслеживания работы приложения и выявления ошибок.

### Структура проекта

```
/order-service
|-- /cmd/
|   |-- /producer/       # Kafka Producer
|   |-- /service/        # Main application
|-- /internal/
|   |-- /app/           # Application layer
|   |-- /cache/         # Cache implementation
|   |-- /config/        # Configuration loading
|   |-- /db/            # Database access layer
|   |-- /handlers/      # HTTP Handlers
|   |-- /kafka/         # Kafka consumer
|   |-- /models/        # Data structures
|-- /front/               # Frontend files
|   |-- index.html
|-- docker-compose.yml  # Docker Compose configuration
|-- go.mod
|-- go.sum
|-- init.sql            # Database initialization script
|-- README.md           # This file
```
